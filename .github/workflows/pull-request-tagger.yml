name: Create tags from Pull Requests 🏷️

on: [pull_request]

jobs:
  tag:
    permissions:
      pull-requests: write
      contents: read
      issues: write
    runs-on: ubuntu-latest
    name: Create tag based on label
    env:
      MAJOR_LABEL: 'version/major 🏗️'
      MINOR_LABEL: 'version/minor 🔨'
      PATCH_LABEL: 'version/patch 🪶'
    steps:
      - name: Checkout code 
        id: checkout-code
        uses: actions/checkout@v4 # I know this is a bad idea and I should do this prolly with GitHub api, this will be fixed later (i.e. never)
        with:
          # The binary versioning depends to on the git annotated tags. 
          # This line forces checkout action to fetch the tags, see
          # https://github.com/actions/checkout/issues/701.
          fetch-depth: 0
      - name: Determine new tag
        id: determine-tag
        run: |
          current_tag=$(git tag --sort=-v:refname | grep '^v' | head -n 1 || echo "v0.0.1")
          
          echo "The latest tag is: ${current_tag}"
